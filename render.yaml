services:
  # Spring Boot API
  - name: medcheck-api
    type: web
    env: docker
    rootDir: medcheckapi
    plan: starter
    autoDeploy: true
    dockerfilePath: Dockerfile
    envVars:
      - key: APP_JWT_SECRET
        generateValue: true
      - key: APP_RESET_BASE_URL
        value: "" # Preencher depois com a URL pública do medcheck-web
      - key: FRONTEND_ORIGINS
        value: "" # Preencher depois com a URL pública do medcheck-web
      # Preencha a seguir com as credenciais do seu banco MySQL (gerenciado no Render)
      - key: SPRING_DATASOURCE_URL
        value: jdbc:mysql://YOUR_MYSQL_HOST:3306/YOUR_DB?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=America/Rio_Branco
      - key: SPRING_DATASOURCE_USERNAME
        value: YOUR_DB_USER
      - key: SPRING_DATASOURCE_PASSWORD
        value: YOUR_DB_PASSWORD

  # Angular SSR Web (serving the app and proxying /api to the backend)
  - name: medcheck-web
    type: web
    env: node
    rootDir: medcheckapp
    plan: starter
    autoDeploy: true
    buildCommand: npm ci && npm run build
    startCommand: node dist/medcheckapp/server/server.mjs
    envVars:
      - key: API_URL
        value: "" # Preencher depois com a URL pública do medcheck-api